PSSDSBPB ;BIR/RTR-Determine numeric dose multiplier for dose call, continued ;02/12/09
 ;;1.0;PHARMACY DATA MANAGEMENT;**117**;9/30/97;Build 101
 ;
 ;
NUMX() ;Determine numeric dose multiplier from Local Possible Dosage
 ;
 ;
 S PSSQVJ1=$E(PSSQVLCD,1,2) I PSSQVJ1="4 " I $$7 S PSSQVJ2=$E(PSSQVLCD,3,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 4
 S PSSQVJ1=$E(PSSQVLCD,1,5) I PSSQVJ1="FOUR " I $$7 S PSSQVJ2=$E(PSSQVLCD,6,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 4
 ;
 S PSSQVJ1=$E(PSSQVLCD,1,2) I PSSQVJ1="3 " I $$7 S PSSQVJ2=$E(PSSQVLCD,3,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 3
 S PSSQVJ1=$E(PSSQVLCD,1,6) I PSSQVJ1="THREE " I $$7 S PSSQVJ2=$E(PSSQVLCD,7,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 3
 ;
 S PSSQVJ1=$E(PSSQVLCD,1,2) I PSSQVJ1="2 " I $$7 S PSSQVJ2=$E(PSSQVLCD,3,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 2
 S PSSQVJ1=$E(PSSQVLCD,1,4) I PSSQVJ1="TWO " I $$7 S PSSQVJ2=$E(PSSQVLCD,5,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 2
 ;
 S PSSQVJ1=$E(PSSQVLCD,1,2) I PSSQVJ1="1 " I $$7 S PSSQVJ2=$E(PSSQVLCD,3,$L(PSSQVLCD)) I $$6,PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2",PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF" Q 1
 S PSSQVJ1=$E(PSSQVLCD,1,4) I PSSQVJ1="ONE " I $$7 S PSSQVJ2=$E(PSSQVLCD,5,$L(PSSQVLCD)) I $$6,PSSQVJ2'["FOURTH",PSSQVJ2'["THIRD",PSSQVJ2'["HALF",PSSQVJ2'["4",PSSQVJ2'["3",PSSQVJ2'["2" Q 1
 ;
 Q 0
 ;
 ;
6() ;
 ;Some special characters in a Nouns will pass, (), etc. others like "/" will not
 I PSSQVJ2[" " Q 0
 I PSSQVJ2["-" Q 0
 I PSSQVJ2["&" Q 0
 I PSSQVJ2["\" Q 0
 I PSSQVJ2["/" Q 0
 Q 1
 ;
7() ;
 I $L(PSSQVLCD)'>$L(PSSQVJ1) Q 0
 Q 1
 ;
 ;
 ;
NUMC() ;Continuation of Free Text Dosage conversion from routine PSSDSAPL
 ;
 S PSSDBV1=$E(PSSDBV9,1,4) I PSSDBV1="3-4 ",$$4 S PSSDBV2=$E(PSSDBV9,5,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,6) I PSSDBV1="3 - 4 ",$$4 S PSSDBV2=$E(PSSDBV9,7,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,7) I PSSDBV1="3 TO 4 ",$$4 S PSSDBV2=$E(PSSDBV9,8,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,7) I PSSDBV1="3 OR 4 ",$$4 S PSSDBV2=$E(PSSDBV9,8,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,14) I PSSDBV1="THREE TO FOUR ",$$4 S PSSDBV2=$E(PSSDBV9,15,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,14) I PSSDBV1="THREE OR FOUR ",$$4 S PSSDBV2=$E(PSSDBV9,15,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,11) I PSSDBV1="THREE-FOUR ",$$4 S PSSDBV2=$E(PSSDBV9,12,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="THREE - FOUR ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 4
 ;
 S PSSDBV1=$E(PSSDBV9,1,2) I PSSDBV1="4 ",$$4 S PSSDBV2=$E(PSSDBV9,3,$L(PSSDBV9)) I $$8 Q 4
 S PSSDBV1=$E(PSSDBV9,1,5) I PSSDBV1="FOUR ",$$4 S PSSDBV2=$E(PSSDBV9,6,$L(PSSDBV9)) I $$8 Q 4
 ;
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="4 AND 1/4 ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 4.25
 S PSSDBV1=$E(PSSDBV9,1,20) I PSSDBV1="FOUR AND ONE FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,21,$L(PSSDBV9)) I $$8 Q 4.25
 S PSSDBV1=$E(PSSDBV9,1,20) I PSSDBV1="FOUR AND ONE-FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,21,$L(PSSDBV9)) I $$8 Q 4.25
 S PSSDBV1=$E(PSSDBV9,1,17) I PSSDBV1="4 AND ONE FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,18,$L(PSSDBV9)) I $$8 Q 4.25
 S PSSDBV1=$E(PSSDBV9,1,17) I PSSDBV1="4 AND ONE-FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,18,$L(PSSDBV9)) I $$8 Q 4.25
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FOUR AND 1/4 ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 4.25
 ;
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="4 AND 1/3 ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 4.33
 S PSSDBV1=$E(PSSDBV9,1,19) I PSSDBV1="FOUR AND ONE THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,20,$L(PSSDBV9)) I $$8 Q 4.33
 S PSSDBV1=$E(PSSDBV9,1,19) I PSSDBV1="FOUR AND ONE-THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,20,$L(PSSDBV9)) I $$8 Q 4.33
 S PSSDBV1=$E(PSSDBV9,1,16) I PSSDBV1="4 AND ONE THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,17,$L(PSSDBV9)) I $$8 Q 4.33
 S PSSDBV1=$E(PSSDBV9,1,16) I PSSDBV1="4 AND ONE-THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,17,$L(PSSDBV9)) I $$8 Q 4.33
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FOUR AND 1/3 ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 4.33
 ;
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="4 AND 1/2 ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 4.5
 S PSSDBV1=$E(PSSDBV9,1,18) I PSSDBV1="FOUR AND ONE HALF ",$$4 S PSSDBV2=$E(PSSDBV9,19,$L(PSSDBV9)) I $$8 Q 4.5
 S PSSDBV1=$E(PSSDBV9,1,18) I PSSDBV1="FOUR AND ONE-HALF ",$$4 S PSSDBV2=$E(PSSDBV9,19,$L(PSSDBV9)) I $$8 Q 4.5
 S PSSDBV1=$E(PSSDBV9,1,15) I PSSDBV1="4 AND ONE HALF ",$$4 S PSSDBV2=$E(PSSDBV9,16,$L(PSSDBV9)) I $$8 Q 4.5
 S PSSDBV1=$E(PSSDBV9,1,15) I PSSDBV1="4 AND ONE-HALF ",$$4 S PSSDBV2=$E(PSSDBV9,16,$L(PSSDBV9)) I $$8 Q 4.5
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FOUR AND 1/2 ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 4.5
 ;
 S PSSDBV1=$E(PSSDBV9,1,4) I PSSDBV1="4-5 ",$$4 S PSSDBV2=$E(PSSDBV9,5,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,6) I PSSDBV1="4 - 5 ",$$4 S PSSDBV2=$E(PSSDBV9,7,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,7) I PSSDBV1="4 TO 5 ",$$4 S PSSDBV2=$E(PSSDBV9,8,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,7) I PSSDBV1="4 OR 5 ",$$4 S PSSDBV2=$E(PSSDBV9,8,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FOUR TO FIVE ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FOUR OR FIVE ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="FOUR-FIVE ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,12) I PSSDBV1="FOUR - FIVE ",$$4 S PSSDBV2=$E(PSSDBV9,13,$L(PSSDBV9)) I $$8 Q 5
 ;
 S PSSDBV1=$E(PSSDBV9,1,2) I PSSDBV1="5 ",$$4 S PSSDBV2=$E(PSSDBV9,3,$L(PSSDBV9)) I $$8 Q 5
 S PSSDBV1=$E(PSSDBV9,1,5) I PSSDBV1="FIVE ",$$4 S PSSDBV2=$E(PSSDBV9,6,$L(PSSDBV9)) I $$8 Q 5
 ;
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="5 AND 1/4 ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 5.25
 S PSSDBV1=$E(PSSDBV9,1,20) I PSSDBV1="FIVE AND ONE FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,21,$L(PSSDBV9)) I $$8 Q 5.25
 S PSSDBV1=$E(PSSDBV9,1,20) I PSSDBV1="FIVE AND ONE-FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,21,$L(PSSDBV9)) I $$8 Q 5.25
 S PSSDBV1=$E(PSSDBV9,1,17) I PSSDBV1="5 AND ONE FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,18,$L(PSSDBV9)) I $$8 Q 5.25
 S PSSDBV1=$E(PSSDBV9,1,17) I PSSDBV1="5 AND ONE-FOURTH ",$$4 S PSSDBV2=$E(PSSDBV9,18,$L(PSSDBV9)) I $$8 Q 5.25
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FIVE AND 1/4 ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 5.25
 ;
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="5 AND 1/3 ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 5.33
 S PSSDBV1=$E(PSSDBV9,1,19) I PSSDBV1="FIVE AND ONE THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,20,$L(PSSDBV9)) I $$8 Q 5.33
 S PSSDBV1=$E(PSSDBV9,1,19) I PSSDBV1="FIVE AND ONE-THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,20,$L(PSSDBV9)) I $$8 Q 5.33
 S PSSDBV1=$E(PSSDBV9,1,16) I PSSDBV1="5 AND ONE THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,17,$L(PSSDBV9)) I $$8 Q 5.33
 S PSSDBV1=$E(PSSDBV9,1,16) I PSSDBV1="5 AND ONE-THIRD ",$$4 S PSSDBV2=$E(PSSDBV9,17,$L(PSSDBV9)) I $$8 Q 5.33
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FIVE AND 1/3 ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 5.33
 ;
 S PSSDBV1=$E(PSSDBV9,1,10) I PSSDBV1="5 AND 1/2 ",$$4 S PSSDBV2=$E(PSSDBV9,11,$L(PSSDBV9)) I $$8 Q 5.5
 S PSSDBV1=$E(PSSDBV9,1,18) I PSSDBV1="FIVE AND ONE HALF ",$$4 S PSSDBV2=$E(PSSDBV9,19,$L(PSSDBV9)) I $$8 Q 5.5
 S PSSDBV1=$E(PSSDBV9,1,18) I PSSDBV1="FIVE AND ONE-HALF ",$$4 S PSSDBV2=$E(PSSDBV9,19,$L(PSSDBV9)) I $$8 Q 5.5
 S PSSDBV1=$E(PSSDBV9,1,15) I PSSDBV1="5 AND ONE HALF ",$$4 S PSSDBV2=$E(PSSDBV9,16,$L(PSSDBV9)) I $$8 Q 5.5
 S PSSDBV1=$E(PSSDBV9,1,15) I PSSDBV1="5 AND ONE-HALF ",$$4 S PSSDBV2=$E(PSSDBV9,16,$L(PSSDBV9)) I $$8 Q 5.5
 S PSSDBV1=$E(PSSDBV9,1,13) I PSSDBV1="FIVE AND 1/2 ",$$4 S PSSDBV2=$E(PSSDBV9,14,$L(PSSDBV9)) I $$8 Q 5.5
 ;
 ;
 Q 0
 ;
8() ;Look for Unit - PSSDBIFL set in PSSSAPD, indicates if Order has a Dispense Drug, or just an Orderable Item
 S PSSDBV3="" D
 .I PSSDBIFL S PSSDBV3=$$UNITD^PSSDSAPI(PSSDBV2) Q
 .S PSSDBV3=$$UNIT^PSSDSAPI(PSSDBV2)
 Q $S(PSSDBV3="":0,1:1)
 ;
 ;
4() ;Validate text follow the numeric part of the text
 I $L(PSSDBV9)'>$L(PSSDBV1) Q 0
 Q 1
