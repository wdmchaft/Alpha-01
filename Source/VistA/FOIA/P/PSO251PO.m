PSO251PO ;BIR/RTR-Post Init for PSO*7*251 ;09/17/09
 ;;7.0;OUTPATIENT PHARMACY;**251**;DEC 1997;Build 202
 ;
 ;
 D MNUADD D BMES^XPDUTL("Generating Mail Message....") D MAIL D BMES^XPDUTL("Mail message sent.")
 Q
 ;
 ;
MAIL ;Send mail message
 N XMTEXT,XMY,XMSUB,XMDUZ,XMMG,XMSTRIP,XMROU,XMYBLOB,XMZ,XMDUN
 S XMSUB="PSO*7*251 Installation Complete"
 S XMDUZ="PSO*7*251 Install"
 S XMTEXT="^TMP($J,""PSO125TX"","
 I $G(DUZ) S XMY(DUZ)=""
 S XMY("G.PSS ORDER CHECKS")=""
 N DIFROM D ^XMD
 K ^TMP($J,"PSO251TX")
 Q
 ;
 ;
MNUADD ;Add PSO ORDER CHECKS VERIFY to PSO MANAGER and PSO USER1 Menu options
 N PSO251CT
 S PSO251CT=1
 K ^TMP($J,"PSO251TX")
 S ^TMP($J,"PSO125TX",PSO251CT)="The installation of patch PSO*7.0*251 is complete."
 D BMES^XPDUTL("Linking PSO ORDER CHECKS VERIFY Option....")
 N PSOMNUA,PSOMNUAF
 S PSOMNUAF=1
 K PSOMNUA S PSOMNUA=$$ADD^XPDMENU("PSO MANAGER","PSO ORDER CHECKS VERIFY") I 'PSOMNUA D MNUADD1
 K PSOMNUA S PSOMNUA=$$ADD^XPDMENU("PSO USER1","PSO ORDER CHECKS VERIFY") I 'PSOMNUA D MNUADD2
 I PSOMNUAF D BMES^XPDUTL("All options linked successfully...")
 Q
 ;
 ;
MNUADD1 ;
 S PSOMNUAF=0
 D BMES^XPDUTL("Unable to link PSO ORDER CHECKS VERIFY to PSO MANAGER Menu Option...")
 D INC S ^TMP($J,"PSO125TX",PSO251CT)="Unable to link PSO ORDER CHECKS VERIFY Option to PSO MANAGER Menu"
 S PSO251CT=PSO251CT+1 S ^TMP($J,"PSO125TX",PSO251CT)="Please Log a Remedy Ticket and refer to this message."
 Q
 ;
 ;
MNUADD2 ;
 S PSOMNUAF=0
 D BMES^XPDUTL("Unable to link PSO ORDER CHECKS VERIFY to PSO USER1 Menu Option...")
 D INC S ^TMP($J,"PSO125TX",PSO251CT)="Unable to link PSO ORDER CHECKS VERIFY Option to PSO USER1 Menu"
 S PSO251CT=PSO251CT+1 S ^TMP($J,"PSO125TX",PSO251CT)="Please Log a Remedy Ticket and refer to this message."
 Q
 ;
 ;
INC ;
 S PSO251CT=PSO251CT+1
 S ^TMP($J,"PSO125TX",PSO251CT)=" "
 S PSO251CT=PSO251CT+1
 Q
